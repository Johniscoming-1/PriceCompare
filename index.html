<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>再点一次就赢了</title>
<style>
body {
    margin: 0;
    background: radial-gradient(circle at center, #111, #000);
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    color: white;
    font-family: "Segoe UI", sans-serif;
}
canvas {
    box-shadow: 0 0 60px rgba(0,255,180,0.3);
    border-radius: 50%;
}
#hint {
    position: absolute;
    bottom: 30px;
    opacity: 0.7;
}
</style>
</head>
<body>

<div id="hint">点击 / 空格 —— 就一次</div>
<canvas id="c" width="420" height="420"></canvas>

<script>
const c = document.getElementById("c");
const ctx = c.getContext("2d");

let angle = 0;
let speed = 0.03;
let score = 0;
let alive = true;

let safeStart = Math.random() * Math.PI * 2;
let safeSize = Math.PI / 5;

function drawRing() {
    ctx.clearRect(0,0,420,420);
    ctx.translate(210,210);

    // ring
    ctx.beginPath();
    ctx.arc(0,0,140,0,Math.PI*2);
    ctx.strokeStyle="#222";
    ctx.lineWidth=18;
    ctx.stroke();

    // safe zone
    ctx.beginPath();
    ctx.arc(0,0,140,safeStart,safeStart+safeSize);
    ctx.strokeStyle="#00ffb0";
    ctx.lineWidth=18;
    ctx.shadowBlur=20;
    ctx.shadowColor="#00ffb0";
    ctx.stroke();
    ctx.shadowBlur=0;

    // pointer
    ctx.rotate(angle);
    ctx.beginPath();
    ctx.moveTo(0,0);
    ctx.lineTo(0,-155);
    ctx.strokeStyle="#fff";
    ctx.lineWidth=4;
    ctx.stroke();

    ctx.resetTransform();

    // score
    ctx.fillStyle="#fff";
    ctx.font="22px Arial";
    ctx.fillText("Score: "+score,20,30);

    if(!alive){
        ctx.fillStyle="#ff5555";
        ctx.font="32px Arial";
        ctx.fillText("失败",170,210);
        ctx.font="16px Arial";
        ctx.fillText("刷新再来一次",145,245);
    }
}

function update() {
    if (!alive) return;
    angle += speed;
    drawRing();
    requestAnimationFrame(update);
}

function hit() {
    if (!alive) return;

    let a = angle % (Math.PI*2);
    let end = safeStart + safeSize;

    if (safeStart < end ? (a > safeStart && a < end) : (a > safeStart || a < end)) {
        // success
        score++;
        speed += 0.005;
        safeSize *= 0.94;
        safeStart = Math.random() * Math.PI * 2;
    } else {
        alive = false;
        drawRing();
    }
}

c.addEventListener("click", hit);
window.addEventListener("keydown", e => {
    if (e.code === "Space") hit();
});

update();
</script>

</body>
</html>
